<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Stickman Game</title>
  <link rel="stylesheet" href="stickbut.css">
  <style>
    #stickman-frame {
      width: 200px;
      height: 200px;
      border: 5px solid black;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px auto;
      transition: background-color 0.3s ease;
      background-color: white;
    }

    #stickman {
      width: 150px;
    }

    .btn.flash {
      transform: scale(1.2);
      box-shadow: 0 0 15px white;
    }
  </style>
</head>
<body>
  <div id="game">
    <div id="stickman-frame">
      <img id="stickman" src="CCTOCNewIdle.gif" alt="–°—Ç—ñ–∫–º–µ–Ω">
    </div>

    <div id="buttons">
      <button class="btn" data-id="0" style="background-color: red;">A</button>
      <button class="btn" data-id="1" style="background-color: green;">B</button>
      <button class="btn" data-id="2" style="background-color: blue;">C</button>
      <button class="btn" data-id="3" style="background-color: orange;">D</button>
      <button class="btn" data-id="4" style="background-color: purple;">E</button>
    </div>

    <div id="level-buttons">
      <button onclick="startGame(5)">–ü–æ—á–∞—Ç–∏ (5 —Ä—ñ–≤–Ω—ñ–≤)</button>
      <button onclick="startGame(10)">–ü–æ—á–∞—Ç–∏ (10 —Ä—ñ–≤–Ω—ñ–≤)</button>
      <button onclick="startGame(15)">–ü–æ—á–∞—Ç–∏ (15 —Ä—ñ–≤–Ω—ñ–≤)</button>
    </div>

    <div id="message">–ù–∞—Ç–∏—Å–Ω–∏ –∫–Ω–æ–ø–∫—É, —â–æ–± –ø–æ—á–∞—Ç–∏ –≥—Ä—É</div>
  </div>

  <script>
    let sequence = [];
    let userSequence = [];
    let level = 0;
    let maxLevel = 5;

    function startGame(levels) {
      maxLevel = levels;
      sequence = [];
      userSequence = [];
      level = 0;
      document.getElementById('message').textContent = "–ü–æ–≤—Ç–æ—Ä–∏ –∑–∞ –°—Ç—ñ–∫–º–µ–Ω–æ–º!";
      nextRound();
    }

    function nextRound() {
      userSequence = [];
      const next = Math.floor(Math.random() * 5);
      sequence.push(next);
      level++;
      showSequence();
    }

    function showSequence() {
      let i = 0;
      const buttons = document.querySelectorAll(".btn");
      const frame = document.getElementById("stickman-frame");

      const interval = setInterval(() => {
        const btn = buttons[sequence[i]];

        // –°–ø–µ—Ä—à—É –æ—á–∏—Å—Ç–∏—Ç–∏ —Ñ–æ–Ω
        frame.style.backgroundColor = "white";

        setTimeout(() => {
          frame.style.backgroundColor = btn.style.backgroundColor; // —Ñ–æ–Ω –∫–Ω–æ–ø–∫–∏
          btn.classList.add("flash");

          setTimeout(() => {
            btn.classList.remove("flash");
            frame.style.backgroundColor = "white";
          }, 500);
        }, 100);

        i++;
        if (i >= sequence.length) clearInterval(interval);
      }, 1000);
    }

    document.querySelectorAll(".btn").forEach(button => {
      button.addEventListener("click", () => {
        const id = parseInt(button.getAttribute("data-id"));
        userSequence.push(id);
        checkSequence();
      });
    });

    function checkSequence() {
      const currentIndex = userSequence.length - 1;
      if (userSequence[currentIndex] !== sequence[currentIndex]) {
        document.getElementById('message').textContent = "‚ùå –ü–æ–º–∏–ª–∫–∞! –ü–æ—á–Ω–∏ –∑–Ω–æ–≤—É.";
        return;
      }

      if (userSequence.length === sequence.length) {
        if (level === maxLevel) {
          document.getElementById('message').textContent = "üéâ –¢–∏ –ø–µ—Ä–µ–º—ñ–≥!";
        } else {
          setTimeout(() => nextRound(), 1000);
        }
      }
    }
  </script>
</body>
</html>